<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>mTouch Framework: Filtering and Decoding</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>Filtering and Decoding</h1>  </div>
</div>
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___decoding.html#ga8955adf440115510aace00d81444e268">mTouch_Decode</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the state of each active-mode sensor using the latest acquisition value.  <a href="#ga8955adf440115510aace00d81444e268"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___decoding.html#gad860d35191988afa8f9d02bcb946c08b">mTouch_UpdateBaseline</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the baseline for the given sensor with the given value.  <a href="#gad860d35191988afa8f9d02bcb946c08b"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The mTouch Filtering and Decoding module executes the detection algorithms for the framework. Using the latched output from the acquisition module, the service function is called each time a new value is available for each sensor. It will then loop through all of the active sensors and determine if they have changed state.</p>
<p>This is achieved by implementing a baseline average of the sensor's reading. The baseline is only updated while the sensor is in the <a class="el" href="m_touch_8h.html#a7d72b112c35bc51408030eb7ecdcacd2a9171b63f68c2e5ed308f9700e824cbbe" title="Sensor is currently released.">MTOUCH_RELEASED</a> state. The difference between the baseline and the current reading is compared against the <a class="el" href="group___configuration.html#ga8c11f6ba7531c370675de59c8298c63f" title="Defines the press threshold of the active-mode sensor with index 0.">THRESHOLD_PRESS_SENSOR0</a> (or equivalent) value to determine if a change in state is necessary.</p>
<p>If the system sees that the reading has dipped below the baseline - the opposite direction of a finger press - the baseline will update itself based on the behavior chosen by configuration option MTOUCH_NEGATIVE_CAPACITANCE. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga8955adf440115510aace00d81444e268"></a><!-- doxytag: member="mTouch.c::mTouch_Decode" ref="ga8955adf440115510aace00d81444e268" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mTouch_Decode </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Updates the state of each active-mode sensor using the latest acquisition value. </p>
<p>This is the mTouch service routine that performs sensor state transitions based on the value of the latest acquisition value as compared to its previous behavior. </p>

<p><p>3. Now that all sensors have had their initial decoding step completed, if sliders are implemented in this application, perform decoding on them now.</p>
<p>6. Finally, if all active sensors are initialized and the system is not about to change modes, send communications data.</p>
<p>7. Enable active-mode mTouch scanning now that we're finished.</p>
</p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l00391">391</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the call graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="group___decoding_ga8955adf440115510aace00d81444e268_cgraph.png" border="0" usemap="#group___decoding_ga8955adf440115510aace00d81444e268_cgraph" alt=""/></div>
<map name="group___decoding_ga8955adf440115510aace00d81444e268_cgraph" id="group___decoding_ga8955adf440115510aace00d81444e268_cgraph">
<area shape="rect" id="node3" href="m_touch_8c.html#a375aad16aafd424786ba67e79cc454d3" title="mTouch_ButtonStateMachine" alt="" coords="175,5,367,35"/><area shape="rect" id="node5" href="m_touch_8h.html#a5c62bf914c0353b75955a34212c1faae" title="mTouch_ChangeMode" alt="" coords="196,59,345,88"/><area shape="rect" id="node7" href="group___decoding.html#gad860d35191988afa8f9d02bcb946c08b" title="Updates the baseline for the given sensor with the given value." alt="" coords="188,112,353,141"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
<a class="anchor" id="gad860d35191988afa8f9d02bcb946c08b"></a><!-- doxytag: member="mTouch.c::mTouch_UpdateBaseline" ref="gad860d35191988afa8f9d02bcb946c08b" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mTouch_UpdateBaseline </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Updates the baseline for the given sensor with the given value. </p>
<p>Updates a sensor's baseline (or baseline) in order to track the environmental changes of the system. </p>

<p><h2><a class="anchor" id="UAvgImp"></a>
Algorithm Implementation Notes</h2>
<p>This function has several possible implementations based on the current configuration options of the framework. The important configuration options are: </p>
<ul>
<li><a class="el" href="group___configuration.html#gafa2edfcf68bc82977e1bc3060172a047" title="Sets the update rate of the baseline when unpressed.">MTOUCH_BASELINE_RATE</a> - acts as a debounce counter for updating the baseline only every N scans. </li>
<li><a class="el" href="group___configuration.html#gaac9ab1199630391c24a76945f7039118" title="Determines the weight given to the raw value when updating the baseline.">MTOUCH_BASELINE_WEIGHT</a> - determines what weight to give the reading when updating the baseline.</li>
</ul>
<p>The average updates the counter variable and compares it with <a class="el" href="group___configuration.html#gafa2edfcf68bc82977e1bc3060172a047" title="Sets the update rate of the baseline when unpressed.">MTOUCH_BASELINE_RATE</a> to see if it should continue or return. If the counter allows it to continue, the average is then updated using one of four possible implementations which is determined by the <a class="el" href="group___configuration.html#gaac9ab1199630391c24a76945f7039118" title="Determines the weight given to the raw value when updating the baseline.">MTOUCH_BASELINE_WEIGHT</a> option.</p>
<p><br/>
<br/>
<br/>
 </p>
</p>

<p>Definition at line <a class="el" href="m_touch_8c_source.html#l01021">1021</a> of file <a class="el" href="m_touch_8c_source.html">mTouch.c</a>.</p>

<p><!-- startSectionHeader --><div class="dynheader">
Here is the caller graph for this function:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="group___decoding_gad860d35191988afa8f9d02bcb946c08b_icgraph.png" border="0" usemap="#group___decoding_gad860d35191988afa8f9d02bcb946c08b_icgraph" alt=""/></div>
<map name="group___decoding_gad860d35191988afa8f9d02bcb946c08b_icgraph" id="group___decoding_gad860d35191988afa8f9d02bcb946c08b_icgraph">
<area shape="rect" id="node3" href="group___decoding.html#ga8955adf440115510aace00d81444e268" title="Updates the state of each active&#45;mode sensor using the latest acquisition value." alt="" coords="223,5,340,35"/></map>
<!-- endSectionContent --></div>
</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>mTouch Framework v2.1 documentation by&#160;
<a href="http://www.microchip.com"> 
<img class="footer" src="../includes/mchp.jpeg" alt="Click here to visit our website at www.microchip.com"/></a></small></address> 
</body> 
</html> 
