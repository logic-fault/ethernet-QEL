<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>mTouch Framework: PC Communications :: One-way UART ASCII output</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="main.html">main</a>      </li>
      <li><a class="el" href="troubleshoot.html">Troubleshooting</a>      </li>
      <li><a class="el" href="ts-_comms.html">PC Communications - Troubleshooting</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>PC Communications :: One-way UART ASCII output </h1>  </div>
</div>
<div class="contents">
<ol>
<li>
<p class="startli">Make sure the <a class="el" href="m_comm__config_8h.html" title="mComm Configuration! Main configuration file for the mComm module.">mComm_config.h</a> file is properly configured. </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #define MCOMM_ENABLED</span>
<span class="preprocessor"></span><span class="preprocessor"> #define MCOMM_TYPE                    MCOMM_UART_ONE_WAY</span>
<span class="preprocessor"> #define MCOMM_UART_BAUDRATE           38400                       // (or) other valid baud rate option</span>
</pre></div> <div class="fragment"><pre class="fragment"><span class="preprocessor"> #define MCOMM_UART_1WAY_MODULE        MCOMM_UART_HARDWARE_MODULE  // (or) MCOMM_UART_SOFTWARE_IMPLEMENTATION</span>
<span class="preprocessor"></span> 
     <span class="comment">// If MCOMM_UART_SOFTWARE_IMPLEMENTATION is chosen:</span>
<span class="preprocessor">     #define MCOMM_UART_SOFT_TXPORT        PORTA</span>
<span class="preprocessor"></span><span class="preprocessor">     #define MCOMM_UART_SOFT_TXTRIS        TRISA   </span>
<span class="preprocessor"></span><span class="preprocessor">     #define MCOMM_UART_SOFT_TXPIN         5       // &lt;-- The bit of the PORT/TRIS register</span>
<span class="preprocessor">                                                   //     NOT the hardware pin on the device</span>
</pre></div> <div class="fragment"><pre class="fragment"><span class="preprocessor"> #define MCOMM_UART_1WAY_OUTPUT        MCOMM_UART_1WAY_DECIMAL     // (or) MCOMM_UART_1WAY_HEX        </span>
<span class="preprocessor"> #define MCOMM_UART_1WAY_DELIMITER     &#39;;&#39;                         </span>
</pre></div><p> If you wish to use the PIC18F PIC24F One-Way GUI, force the mComm module to follow the GUI's packet structure by defining this value: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #define MCOMM_UART_1WAY_OUT_GUIv1_1</span>
</pre></div><p> The following options will determine what values are output by the UART. Matrix output is not supported by the GUI but may be seen from a terminal window. </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #define MCOMM_UART_1WAY_OUT_STATE             // &lt;-- If defined, outputs the state mask</span>
<span class="preprocessor"></span><span class="preprocessor"> #define MCOMM_UART_1WAY_OUT_TOGGLE            // &lt;-- If defined, outputs the toggle state mask</span>
<span class="preprocessor"></span><span class="preprocessor"> #define MCOMM_UART_1WAY_OUT_SLIDER            // &lt;-- If defined, outputs the slider output value</span>
<span class="preprocessor"></span><span class="preprocessor"> #define MCOMM_UART_1WAY_OUT_MATRIX            // &lt;-- If defined, outputs the matrix press coordinate</span>
<span class="preprocessor"></span><span class="preprocessor"> #define MCOMM_UART_1WAY_OUT_READING           // &lt;-- If defined, outputs the raw reading values</span>
<span class="preprocessor"> #define MCOMM_UART_1WAY_OUT_BASELINE          // &lt;-- If defined, outputs the sensor baseline values</span>
</pre></div><p>If you are using a processor with an APFCON register that allows for multiple pins to be used as 'TX', your application is responsible for initializing APFCON to the correct value for your hardware layout. The mTouch framework will warn you about this when compiling. To remove this warning, uncomment the define at the bottom of <a class="el" href="m_touch__config_8h.html" title="Framework Configuration! Main configuration file for the mTouch Framework.">mTouch_config.h</a>: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor"> #define APFCON_INITIALIZED    // For processors with an APFCON register(s), this </span>
<span class="preprocessor"></span>                               <span class="comment">// #define can be uncommented to stop the mTouch </span>
                               <span class="comment">// Framework from producing a &quot;remember to set </span>
                               <span class="comment">// APFCON&quot; warning.</span>
                               <span class="comment">//</span>
                               <span class="comment">// RULE OF PROGRAMMING #4: Register bits initialize, </span>
                               <span class="comment">//      by law, to the value you don&#39;t want. Always </span>
                               <span class="comment">//      explicitly initialize.</span>
</pre></div><p class="endli"></p>
</li>
<li>
<p class="startli">Program the board normally (not in debug mode) and connect the PKSA to both the PC and the board.<br/>
</p>
<p class="endli"></p>
</li>
<li>
Make sure both the PIC and the PKSA are being supplied with power. Either: <ul>
<li>
Supply power to the PIC from an external source that is also supplying power to the PKSA's PWR and GND pins. </li>
<li>
Supply power to the PIC from the PKSA by pressing and holding the black button for 3 seconds until the green power LED turns on. </li>
<li>
Supply power to the PIC from an external source that is NOT connected to the PWR/GND pins of the PKSA and then supply power to the PKSA by pressing on its black button for 3 seconds until the green power LED turns on. </li>
</ul>
<dl class="note"><dt><b>Note:</b></dt><dd>Be careful not to supply power to the PIC from two different sources as you may destroy the board.</dd></dl>
</li>
<li>
<p class="startli">Is the PKSA's red LED on?<br/>
 If no - </p>
<ul>
<li>
Use a scope to verify the TX pin of the PKSA is receiving data from the PIC. </li>
<li>
If it is, the PKSA's firmware has not been updated to perform as a UART-to-USB converter. See <a class="el" href="_p_k_s_a_r_s232.html">this guide</a> on using the PKSA loader utility to reflash the PICKit Serial Analyzer's firmware. </li>
</ul>
<p>If yes - continue to 5.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Determine which COM port has been assigned to the PKSA.<br/>
 In Windows - </p>
<ul>
<li>
Right click 'My Computer' --&gt; Properties --&gt; Hardware --&gt; Device Manager </li>
<li>
You should find it listed under "Ports (COM)". </li>
</ul>
<p>If it's not there, you need to reinstall the Windows driver for the UART-to-USB behavior. The driver can be found in the PKSA Loader Utility's folder. Correct installation is based on the version of Windows you are using, but can be accomplished by right clicking the file and selecting 'Install' in most cases.</p>
<p class="endli"></p>
</li>
<li>
Open the mTouch One-Way GUI and make sure the communication settings are set to:<br/>
<br/>
 <ul>
<li>
The baud rate you have chosen for MTOUCH_UART_BAUDRATE in <a class="el" href="m_comm__config_8h.html" title="mComm Configuration! Main configuration file for the mComm module.">mComm_config.h</a>. </li>
<li>
COM Port dependant on current assignment in Device Manager. </li>
</ul>
</li>
</ol>
</div>
<hr class="footer"/><address class="footer"><small>mTouch Framework v2.1 documentation by&#160;
<a href="http://www.microchip.com"> 
<img class="footer" src="../includes/mchp.jpeg" alt="Click here to visit our website at www.microchip.com"/></a></small></address> 
</body> 
</html> 
